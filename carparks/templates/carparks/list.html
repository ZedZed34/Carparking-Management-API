{% extends "base.html" %}

{% block title %}All Car Parks{% endblock %}

{% block content %}
<div class="card shadow-sm p-4">
  <h2 class="card-title mb-4">All Car Parks</h2>
  <div class="mb-3 d-flex gap-2">
    <input class="form-control" id="q" placeholder="Search address..." />
    <button class="btn btn-primary" id="refresh">Refresh</button>
  </div>
  <div id="list" class="mt-3"></div>
</div>

<script>
async function load(q = "") {
  const resp = await fetch('/api/v1/carparks/');
  if (!resp.ok) return;
  const data = await resp.json();
  const filtered = q ? data.filter(i => String(i.address).toLowerCase().includes(q.toLowerCase())) : data;
  const html = filtered.map(i => `
    <div class="border rounded p-2 mb-2">
      <div><strong>${i.car_park_type}</strong></div>
      <div>${i.address}</div>
    </div>
  `).join('');
  document.getElementById('list').innerHTML = html || '<div class="text-muted">No results</div>';
}

document.getElementById('refresh').addEventListener('click', () => load(document.getElementById('q').value));
document.getElementById('q').addEventListener('input', (e) => load(e.target.value));
load();
</script>
{% endblock %}






